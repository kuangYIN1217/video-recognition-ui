<div class="container">
  <div class="video-wrapper">
    <div class="left-bar">
      <img src="assets/appdetail/video-analysis/toggleRight.png" (click)="show_rule()" [ngClass]="{anmationRight:leftbar}" class="toggleRight" id="toggleRight"/>
      <img src="assets/appdetail/video-analysis/toggleLeft.png" (click)="show_rule()" [ngClass]="{anmationLeft:!leftbar}" class="toggleLeft" id="toggleLeft"/>
    </div>
    <!-- 视频区域 -->
    <div class="right-content">
      <div (mousedown)="$grid_click(1 , $event)" [ngStyle]="ngStyle_grid_selected(1)" class="player-item index1" [ngClass]="ngClass_grid(1)" (mouseenter)="showFull(1)" (mouseleave)="hideFull(0)">
        <label class="item-title">{{get_ckplayer_index(1)}}</label>
        <!--<img *ngIf="s_fullscreen_grid === 1" class="item-screenshot" src="assets/appdetail/video-analysis/icon_screenshot_h.png" alt="" title="屏幕截图" [style.display]="fullscreenIndex1==1&&d_video_list.length>=1?'':'none'">-->
        <img *ngIf="!get_switch(1)" (mousedown)="$channel_click(1, $event)"  [src]="get_switch_icon_url(1)" class="item-switch" [style.display]="fullscreenIndex1==1&&d_video_list.length>=1?'':'none'"/>
        <img *ngIf="get_switch(1)" (mousedown)="$channel_click(1, $event)"  [src]="get_switch_off_icon_url(1)" class="item-switch" [style.display]="fullscreenIndex1==1&&d_video_list.length>=1?'':'none'"/>
        <img (mousedown)="$fullscreen_click(1 , $event)" [style.display]="fullscreenIndex1==1&&d_video_list.length>=1?'':'none'" [src]="get_fullscreen_icon_url(1)" alt="" class="item-fullscreen" title="全屏" *ngIf="s_fullscreen_grid!=1">
        <img (mousedown)="$fullscreen_click(1 , $event)" [style.display]="fullscreenIndex1==1?'':'none'" [src]="get_fullscreen_icon_url(1)" alt="" class="item-fullscreen" title="缩小" *ngIf="s_fullscreen_grid===1">
        <img (mousedown)="$add_video_click(1 , $event)" *ngIf="ngIfaddVideo(1)" src="assets/appdetail/video-analysis/add_video.png" alt="" class="item-add-video" title="新增通道">
        <jwplayer *ngIf="get_ckplayer_exist(1)"  [url]="get_ckplayer_url(1)"></jwplayer>
      </div>
    </div>
  </div>
<!-- leftbar -->
  <div class="analysis-rule" [ngStyle]="getSideBarHeight()">
    <div class="analysis-rule-header">
      <span>告警规则</span>
      <span (click)="createRule()" [ngClass]="{createBtn: !create_show}">新建</span>
    </div>
    <div class="analysis-rule-content">
<!--      <div class="analysis-rule-remind">
        <label>告警提醒</label>
        <div>
          <span class="switch">
            <img [src]="switch=='start'?'assets/appdetail/way.manage/radio.png':'assets/appdetail/way.manage/unradio.png'" class="middle" (click)="switchToggle('start')"/>
            <span class="middle">开启</span>
          </span>
          <span class="switch end">
            <img [src]="switch=='end'?'assets/appdetail/way.manage/radio.png':'assets/appdetail/way.manage/unradio.png'" class="middle" (click)="switchToggle('end')"/>
            <span class="middle">关闭</span>
          </span>
        </div>
      </div>-->
      <div class="create-rule" *ngIf="create_show">
        <div class="info">
          <label>规则名称：</label>
          <input type="text" name="ruleName" [(ngModel)]="ruleName" (blur)="checkName()"/>
        </div>
        <div class="must" [style.display]="chanRequired1==1?'':'none'">必填字段</div>
        <div class="must" [style.display]="ruleNameMust==1?'':'none'">该名称已存在</div>
        <div class="info" style="height: auto;margin-bottom: 0">
          <label>告警对象：</label>
          <select [(ngModel)]="warnObj" (ngModelChange)="warnObj=$event;changeWarn()">
            <option value="{{item.classificationName}}" *ngFor="let item of warnObjArr">{{item.classificationName}}</option>
          </select>
          <select class="detail" [(ngModel)]="warnObjDetail" (ngModelChange)="warnObjDetail=$event;changeDetail()">
            <option value="{{item.name}}" *ngFor="let item of warnObjDetailArr">{{item.name}}</option>
          </select>
        </div>
        <div class="info" *ngIf="identifyName=='人'">
          <label>对象特征：</label>
          <span class="personNum">人名</span>
          <input type="text" class="person" name="personName" [(ngModel)]="personName" onkeyup="value=value.replace(/[^\w\.\/]/ig,'')"/>
        </div>
        <div class="info" style="padding-left: 120px;height: auto;" *ngIf="identifyName=='人'">
          <span class="pohotText">特征图片</span>
          <div class="showPhoto">
             <span  *ngFor="let item of photoContainer;let i=index">
               <img src="{{SERVER_URL}}/download/{{outputImg(item)}}" alt="" class="photo">
               <img src="../assets/appmanage/delete.png" class="del" (click)="delPhoto(i)"/>
             </span>
          </div>
          <a href="javascript:void(0)" class="btn" id="upload" style="color: #333;" onclick="document.getElementById('file').click()">上传</a>
          <input type="file" multiple id="file" name="file" ng2FileSelect [uploader]="uploader" accept=".jpg,.png" (change)="selectedFileOnChanged($event)"/>
          <span class="zhushi">注：人名仅支持英文输入，特征图片支持格式jpg、png</span>
        </div>
        <div class="ruleBtn">
          <a href="javascript:void(0)" class="btn bgco" (click)="saveRule()">保存</a>
          <a href="javascript:void(0)" class="btn bgcg" style="margin-left: 16px" (click)="cancelRule()">取消</a>
        </div>
      </div>
      <div class="all-rule">
        <div class="single-rule" *ngFor="let item of rulesInfo">
          <img [src]="item.selected?'assets/appdetail/way.manage/radio.png':'assets/appdetail/way.manage/unradio.png'" class="middle" (click)="choose_rule(item)"/>
          <span class="middle rule-name">{{item.ruleName}}</span>
        </div>
      </div>
      <div class="submit" [style.display]="btn_show?'':'none'">
        <div (click)="$change_analysis_submit()" class="btn bgco" style="margin-left: 27px;margin-top: 40px">确定</div>
        <div href="javascript:void(0)" class="btn bgcg" style="margin-left: 16px" (click)="$cancel_analysis_submit()">取消</div>
      </div>
    </div>
  </div>
  <ng2-toasty class="toasty" [position]="'top-center'"></ng2-toasty>

  <div class="dialog" [style.display]="addDialog==1?'':'none'">
    <div class="dialogContainer addDialogContainer">
      <div class="dialogHeader">
        <span>新增通道</span>
      </div>
      <div class="dialogContent">
        <div class="info">
          <label>通道名称：</label>
          <input type="text" name="chanName" [(ngModel)]="chanName"/>
          <span class="must" [style.display]="chanRequired1==1?'':'none'">必填字段</span>
        </div>
        <div class="info">
          <label>通道地址：</label>
          <input type="text" name="chanAddr" [(ngModel)]="chanAddr"/>
          <span class="must" [style.display]="chanRequired2==1?'':'none'">必填字段</span>
        </div>
        <div class="info">
          <label>通道协议：</label>
          <select [(ngModel)]="protocol" (ngModelChange)="protocol=$event;">
            <option value="{{i}}" *ngFor="let i of protocols">{{i}}</option>
          </select>
        </div>
        <div class="info">
          <label>通道类型：</label>
          <select [(ngModel)]="channelType" (ngModelChange)="channelType=$event;">
            <option value="{{i}}" *ngFor="let i of channelTypes">{{i}}</option>
          </select>
        </div>
<!--        <div class="info">
          <label>视频地址：</label>
          <input type="text" name="videoAddress" [(ngModel)]="videoAddress"/>
        </div>-->
        <div class="info">
          <label>是否开启：</label>
          <span class="radio">
            <img src="../assets/appdetail/way.manage/unradio.png" class="middle" *ngIf="radioIndex!=1" (click)="radio(1)"/>
            <img src="../assets/appdetail/way.manage/radio.png" class="middle" *ngIf="radioIndex==1" (click)="radio(1)"/><span class="middle fontSize">开启</span>
            <img src="../assets/appdetail/way.manage/unradio.png" class="middle" *ngIf="radioIndex!=0" (click)="radio(0)" style="margin-left: 20px"/>
            <img src="../assets/appdetail/way.manage/radio.png" class="middle" *ngIf="radioIndex==0" (click)="radio(0)" style="margin-left: 20px"/><span class="middle fontSize">关闭</span>
          </span>
        </div>
        <div class="infoBtn">
          <a href="javascript:void(0)" class="btn bgco" style="margin-left: 28px" (click)="create()">创建</a>
          <a href="javascript:void(0)" class="btn bgcg" style="margin-left: 28px" (click)="cancel()">取消</a>
        </div>
      </div>
    </div>
  </div>
  <app-tips [style.display]="deleteIndex==1?'':'none'" [tip_title]="tip_title" [tip_content]="tip_content" [deleteIndex]="deleteIndex" [tip_btn]="tip_btn" (deleteChange)="deleteChange($event)" (deletedChange)="deletedChange($event)"></app-tips>
</div>
